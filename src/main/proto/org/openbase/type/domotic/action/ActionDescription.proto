syntax = "proto2";

package org.openbase.type.domotic.action;

option java_outer_classname = "ActionDescriptionType";

import "org/openbase/type/language/Label.proto";
import "org/openbase/type/language/MultiLanguageText.proto";
import "org/openbase/type/domotic/state/ActionState.proto";
import "org/openbase/type/domotic/action/ActionInitiator.proto";
import "org/openbase/type/domotic/action/ActionReference.proto";
import "org/openbase/type/domotic/service/ServiceStateDescription.proto";
import "org/openbase/type/domotic/action/ActionPriority.proto";
import "org/openbase/type/domotic/action/ActionEmphasis.proto";
import "org/openbase/type/timing/Timestamp.proto";

/**
 * Description of an action.
 *
 * @author Marian Pohling <mpohling@cit-ec.uni-bielefeld.de>
 * @author Tamino Huxohl <thuxohl@techfak.uni-bielefeld.de>
 */
message ActionDescription {

    /**
     * An id for the action description.
     *
     * Note: Field is auto generated by the controller instance.
     */
    optional string id = 10;

    /**
     * A label for the action description.
     */
    optional .org.openbase.type.language.Label label = 20;

    /**
     * A description for the action description.
     *
     * Note: Field is auto generated by the controller instance.
     */
    optional .org.openbase.type.language.MultiLanguageText description = 30;

    /**
     * Flag defines if this action is an intermediary element in the action chain.
     * If the action is intermediary, they will never be scheduled or its action state updated.
     * The actions on the action_impact list can be observed to determine the process of an intermediary action.
     */
    optional bool intermediary = 35;

    /**
     * The initiator of this action.
     */
    optional .org.openbase.type.domotic.action.ActionInitiator action_initiator = 40;

    /**
     * The execution state of this action.
     *
     * Note: Field is auto generated and updated by the controller instance.
     */
    optional .org.openbase.type.domotic.state.ActionState action_state = 50;

    /**
     * A list of actions (scheduled and passive actions) which caused this action.
     * This list represent the complete upper part of the action chain.
     */
    repeated .org.openbase.type.domotic.action.ActionReference action_cause = 60;

    /**
     * A list of scheduled actions which were initiated by this action.
     * The list is a spare representation of the lower part of the action
     * chain because it only contains the scheduled end point actions.
     */
    repeated .org.openbase.type.domotic.action.ActionReference action_impact = 65;

    /**
     * The state which this action shall apply.
     */
    optional .org.openbase.type.domotic.service.ServiceStateDescription service_state_description = 70;

    /**
     * The execution priority of this action used for the action ranking.
     *
     * Note: Default priority is NORMAL
     */
    optional .org.openbase.type.domotic.action.ActionPriority.Priority priority = 80 [default = NORMAL];

    /**
     * The emphasis categories representing the optimization intention of this action used for the ranking.
     */
    repeated .org.openbase.type.domotic.action.ActionEmphasis.Category category = 90;

    /**
     * The defined runtime period of this action in microsecunds.
     * The action will be finished or rejected (if prevously scheduled) after expiration.
     * If set to 0 then the action will only be executed ones if no other action is blocking the unit to avoid state flickering.
     */
    optional uint64 execution_time_period = 100;

    /**
     * Flag defines if an currently scheduled or executing action should be canceled.
     * To perform a cancelation of a running action, only this flag and the id of the action is needed.
     */
    optional bool cancel = 110 [default = false];

    /**
     * Flag defines if the action execution can be continued after interruption.
     * This means if this action was relegated by another one, it is directly rejected and whill not be scheduled again.
     */
    optional bool interruptible = 120 [default = true];

    /**
     * Flag defines if this action supports it, to be scheduled.
     * If not than the action will directly rejected in case a currenly higher ranked action is blocking the unit.
     */
    optional bool schedulable = 130 [default = true];

    /**
     * The time when this action was created.
     */
    optional .org.openbase.type.timing.Timestamp timestamp = 140;
}

