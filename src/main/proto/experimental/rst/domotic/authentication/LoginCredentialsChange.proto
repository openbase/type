syntax = "proto2";

package rst.domotic.authentication;

option java_outer_classname = "LoginCredentialsChangeType";

import "rst/domotic/authentication/TicketAuthenticatorWrapper.proto";

/**
 * Used to change login credentials.
 *
 * @author Constantin Romankiewicz <cromankiewicz@techfak.uni-bielefeld.de>
 */
message LoginCredentialsChange {

    /**
     * ID of the user or client to set the credentials for.
     */
    optional string id = 1;

    /**
     * Old credentials (hashed and encrypted with SS session key).
     */
    optional bytes old_credentials = 2;

    /**
     * New credentials (hashed and encrypted with SS session key).
     */
    optional bytes new_credentials = 3;

    /**
     * CST and Authenticator to authenticate the user who wants to change credentials.
     */
    optional .rst.domotic.authentication.TicketAuthenticatorWrapper ticket_authenticator_wrapper = 4;

    /**
     * If the admin flag for the user should be changed, this field contains the new value.
     */
    optional bool admin = 5;
}

